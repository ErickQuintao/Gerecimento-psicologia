<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Detalhes do Atendimento</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <div class="container mt-5">
        <h2 th:text="'Atendimento ID: ' + ${atendimento.id}"></h2>

        <h3>Dados Atuais do Atendimento</h3>
        <p><strong>Nome:</strong> <span th:text="${atendimento.nome}"></span></p>
        <p><strong>Horário Inicial:</strong> <span th:text="${#dates.format(atendimento.horarioInicial, 'dd/MM/yyyy HH:mm')}"></span></p>
        <p><strong>Horário Final:</strong> <span th:text="${#dates.format(atendimento.horarioFinal, 'dd/MM/yyyy HH:mm')}"></span></p>
        <p><strong>Valor:</strong> <span th:text="${atendimento.valor}"></span></p>
        <p><strong>Desconto:</strong> <span th:text="${atendimento.desconto}"></span></p>
        <p><strong>Valor Total:</strong> <span th:text="${atendimento.valorTotal}"></span></p>
        <p><strong>Método de Pagamento:</strong> <span th:text="${atendimento.metodoPagamento}"></span></p>
        <p><strong>Status:</strong> <span th:text="${atendimento.status}"></span></p>
        <p><strong>Convênio:</strong> <span th:text="${atendimento.convenio}"></span></p>
        <p><strong>Descrição:</strong> <span th:text="${atendimento.descricao}"></span></p>

        <h3>Atualizar Atendimento</h3>
        <form id="atendimentoForm">
            <input type="hidden" id="atendimentoId" th:value="${atendimento.id}" />
            
            <div class="mb-3">
                <label for="nome" class="form-label">Nome</label>
                <input type="text" class="form-control" id="nome" th:value="${atendimento.nome}" required>
            </div>
            <div class="mb-3">
                <label for="horarioInicial" class="form-label">Horário Inicial</label>
                <input type="datetime-local" class="form-control" id="horarioInicial" th:value="${#dates.format(atendimento.horarioInicial, 'yyyy-MM-dd\'T\'HH:mm')}" required>
            </div>
            <div class="mb-3">
                <label for="horarioFinal" class="form-label">Horário Final</label>
                <input type="datetime-local" class="form-control" id="horarioFinal" th:value="${#dates.format(atendimento.horarioFinal, 'yyyy-MM-dd\'T\'HH:mm')}" required>
            </div>
            <div class="mb-3">
                <label for="valor" class="form-label">Valor</label>
                <input type="number" class="form-control" id="valor" th:value="${atendimento.valor}" required>
            </div>
            <div class="mb-3">
                <label for="desconto" class="form-label">Desconto</label>
                <input type="number" class="form-control" id="desconto" th:value="${atendimento.desconto}" required>
            </div>
            <div class="mb-3">
                <label for="valorTotal" class="form-label">Valor Total</label>
                <input type="number" class="form-control" id="valorTotal" th:value="${atendimento.valorTotal}" required>
            </div>
            <div class="mb-3">
                <label for="metodoPagamento" class="form-label">Método de Pagamento</label>
                <select class="form-select" id="metodoPagamento" required>
                    <option th:value="${atendimento.metodoPagamento}" th:text="${atendimento.metodoPagamento}" selected></option>
                    <option value="dinheiro">Dinheiro</option>
                    <option value="PIX">PIX</option>
                    <option value="cartão">Cartão</option>
                </select>
            </div>
            <div class="mb-3">
                <label for="status" class="form-label">Status</label>
                <select class="form-select" id="status" required>
                    <option th:value="${atendimento.status}" th:text="${atendimento.status}" selected></option>
                    <option value="agendado">Agendado</option>
                    <option value="andamento">Em Andamento</option>
                    <option value="finalizado">Finalizado</option>
                </select>
            </div>
            <div class="mb-3">
                <label for="convenio" class="form-label">Convênio</label>
                <input type="text" class="form-control" id="convenio" th:value="${atendimento.convenio}" required>
            </div>
            <div class="mb-3">
                <label for="descricao" class="form-label">Descrição</label>
                <textarea class="form-control" id="descricao" required th:text="${atendimento.descricao}"></textarea>
            </div>

            <button type="button" onclick="atualizarAtendimento()" class="btn btn-primary mt-3">Alterar</button>
            <button type="button" onclick="excluirAtendimento()" class="btn btn-danger mt-3">Excluir</button>
        </form>

        <a href="/listar-atendimentos" class="btn btn-secondary mt-3">Voltar para a Lista</a>
    </div>

    <script>
        function atualizarAtendimento() {
       
            var id = document.getElementById("atendimentoId").value;
            var nome = document.getElementById("nome").value;
            var horarioInicial = document.getElementById("horarioInicial").value;
            var horarioFinal = document.getElementById("horarioFinal").value;
            var valor = document.getElementById("valor").value;
            var desconto = document.getElementById("desconto").value;
            var valorTotal = document.getElementById("valorTotal").value;
            var metodoPagamento = document.getElementById("metodoPagamento").value;
            var status = document.getElementById("status").value;
            var convenio = document.getElementById("convenio").value;
            var descricao = document.getElementById("descricao").value;

    
            /*
            $.ajax({
                url: '/atendimentos/atualizar/' + id,
                method: 'POST',
                data: {
                    nome: nome,
                    horarioInicial: horarioInicial,
                    horarioFinal: horarioFinal,
                    valor: valor,
                    desconto: desconto,
                    valorTotal: valorTotal,
                    metodoPagamento: metodoPagamento,
                    status: status,
                    convenio: convenio,
                    descricao: descricao
                },
                success: function(response) {
                    // Lógica para tratar a resposta, como redirecionar para a lista
                    window.location.href = '/listar-atendimentos';
                },
                error: function(error) {
                    // Lógica para tratar erro
                    alert('Erro ao atualizar atendimento.');
                }
            });
            */
        }

        function excluirAtendimento() {
            var id = document.getElementById("atendimentoId").value;

            /*
            $.ajax({
                url: '/atendimentos/excluir/' + id,
                method: 'DELETE',
                success: function(response) {
                    // Lógica para tratar a resposta, como redirecionar para a lista
                    window.location.href = '/listar-atendimentos';
                },
                error: function(error) {
                    // Lógica para tratar erro
                    alert('Erro ao excluir atendimento.');
                }
            });
            */
        }
    </script>
</body>
</html>


